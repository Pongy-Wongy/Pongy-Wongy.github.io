---
layout: single
title: "μƒμ„Ένμ΄μ§€λ§λ“¤κΈ°"
excerpt: "URLνλΌλ―Έν„° λ° Optionalνƒ€μ…μΌλ΅ μƒμ„Ένμ΄μ§€ λ§λ“¤κΈ°"
categories: SpringBoot
tag: SpringBoot
toc: true
published: true
---

κΈ°λ³Έμ μΌλ΅ μ‡Όν•‘λ°κ°™μ€κ²½μ°μ— μƒμ„Ένμ΄μ§€λ΅ κ°€λ©΄
urlμ£Όμ†κ°€ products/μƒν’λ²νΈ μ΄λ ‡κ² μ ν€μ Έ μλ”κ² λ§λ‹¤.

**products/n --> nλ²μƒν’ λ³΄μ—¬μ£Όλ©΄ λ!**
κ·Όλ°μ—¬κΈ°μ„ nμ€ ν…μ΄λΈ”μ— μλ” μƒν’IDκ°’μ΄λ‹¤.
λ§μ•½ nμ΄ 100λ§μ΄λΌλ©΄ νμ΄μ§€100λ§κ°κ°€ ν•„μ”ν•κ³  
κ·Έμ—λ”°λ¥Έ μƒν’νμ΄μ§€APIλ„ 100λ§κ° λ§λ“¤μ–΄μ•Ό ν•λ”λ° λ¶κ°€λ¥!!
URLνλΌλ―Έν„°λΌλ” λ¬Έλ²•μ“°λ©΄ μ‰½κ² λ§λ“¤μ μλ‹¤.


## URL νλΌλ―Έν„°
```java
@GetMapping("/products/{id}")
String detail() {
  return "products.html";
} 
```
{} μ•μ— λ³€μ μ•„λ¬΄κ±°λ‚ λ§λ“¤μ–΄ μ“°λ©΄ λλ”λ° λ’¤μ— μ¤λ” λ²νΈκ°€
μƒν’IDλ²νΈμ—¬μ„ {id}λΌκ³  ν–μ

κ·ΈλΌμ΄μ  products/nμΌλ΅ μ ‘μ†ν•λ©΄ nλ²μƒν’μ„ DBμ—μ„ κ°€μ Έμ™€μ„
html μ§‘μ–΄λ„£μΌλ©΄ λλ‹¤. 
κ·Όλ° n=idμΈ ν–‰μ„ ν…μ΄λΈ”μ—μ„ μ¶λ ¥ν•λ” λ°©λ²•μ€ λ­κΉ?
κµ¬κΈ€μ— κ²€μƒ‰ν•΄λ³΄μ!!

![Spring μ΄λ―Έμ§€](/assets/images/spring08.png)
μ„μμ‚¬μ§„κ³Ό κ°™μ΄ .findByIdλ” μ΅°νλ @Entityλ¥Ό Optional
κ°μ²΄λ΅ λ°ν™ν•λ‹¤. 

```java
@GetMapping("/products/{id}")
String detail() {
  Optional<Product> result = productRepository.findById(1);
  System.out.println(result.get());
  return "products.html";
} 
```

## Optional<> νƒ€μ…
Optional νƒ€μ…μ νΉμ§•μ€ **κ°’μ΄ μμ„ μλ„ μκ³  μ—†μ„ μλ„ μλ”** νƒ€μ…μ΄λ‹¤.

Optionlμ€ .get()μ„ ν•λ©΄ λ°μ΄ν„°λ¥Ό λ¶λ¬μ¬μ μλ‹¤.κ·Όλ° ν…μ΄λΈ”μ—μλ” κ°’μ΄ nullμ΄λ©΄
resultλ³€μμ— μ•„λ¬΄κ²ƒλ„ μ €μ¥λμ§€ μ•κΈ°λ•λ¬Έμ— .get()ν•λ©΄ μ—λ¬κ°€ λ‚  κ²ƒ!!
κ·ΈλΌ μ§μ ‘μ—λ¬λ¥Ό λ‚΄λ³΄μ!!μ›λ μ½”λ”© μν•λ ¤λ©΄ μ—λ¬λ¥Ό λ§λ“¤μ¤„μ•„λ” μ•…μ„±μ μ €κ°€ λλ”κ² μΆ‹λ‹¤!!!

μΌλ‹¨ ν…μ΄λΈ”μ— μλ” λ°μ΄ν„°λ¥Ό λ¨λ‘ μ‚­μ ν–λ‹¤.
κ·Έλ¦¬κ³  /products/1λ΅ μ ‘μ†ν•΄λ³΄λ©΄ μ¤λ¥κ°€ λ‚ κ²ƒμ΄λ‹¤.
μ™ μ¤λ¥κ°€λ‚λƒ? λ‹Ήμ—°ν idκ°€ 1μΈ μƒν’μ΄ μ—†μΌλ‹κΉ!!! μ •λ§μ‰½λ‹¤!!!

![Spring μ΄λ―Έμ§€](/assets/images/spring081.png)

μ„μ²λΌ Optionalμ΄ λΉ„μ–΄μμ„λ• NoSuchElementExceptionμ—λ¬κ°€ λ°μƒν• κ±Έ λ³Ό μ μλ‹¤.
κ·Έλμ„ μ—λ¬λ°©μ§€λ¥Ό μ„ν•΄ Optionalνƒ€μ…μ€ **isPresent**λ‘ κ°™μ΄ λ§μ΄ μ“΄λ‹¤

```java
@GetMapping("/products/{id}")
    String detail() {
        Optional<Product> result = productRepository.findById(1);
        if (result.isPresent()) {
            System.out.println(result.get());
            return "products.html";
        } else {
            return "form.html";
        }
    }
```
resultλ³€μμ— κ°’μ΄ μμΌλ©΄ μƒμ„Ένμ΄μ§€λ¥Ό λ³΄μ—¬μ£Όκ³  μ—†μΌλ©΄
λ‹¤μ‹ κΈ€μ“°κΈ°νμ΄μ§€λ΅ λμ•„κ°€κ²λ” μ½”λ“λ¥Ό μ§λ³΄μ•λ‹¤.
μ΄λ ‡κ² ν•λ©΄ ν…μ΄λΈ”μ— λ°μ΄ν„°κ°€ μ—†μ–΄λ„ μ—λ¬λ¥Ό λ°©μ§€ ν•  μ μλ‹¤.

μ μ΄μ  μ—λ¬λ°©μ§€λ„ ν–κ³  λ‚¨μ€κ±° ν„μ¬ 
products/1,products/2 ......products/999  
λ‹¤ λ‘κ°™μ€ htmlμ •λ³΄λ§ λ³΄μ—¬μ£Όκ³ μλ‹¤. 
htmlμ— μ„λ²„ λ°μ΄ν„°λ¥Ό ν•λ ¤λ©΄? μ €λ²μ‹κ°„μ— λ°°μ› λ‹¤.

## λ³µμµ: HTMLμ— μ„λ²„λ°μ΄ν„° μ§‘μ–΄λ„£κΈ°
1. νλΌλ―Έν„°() μ•μ— Model model
2. model.addAttribute(β€μ „λ‹¬ν•λ°μ΄ν„°μ΄λ¦„β€,β€λ°μ΄ν„°β€);
3. htmlνμΌμ—μ„ th:text=β€${μ „λ‹¬ν• λ°μ΄ν„°μ΄λ¦„}β€

κ·Έλ¦¬κ³  urlνλΌλ―Έν„°μ™€ @PathVariableμ„ κ°™μ΄ μ‚¬μ©ν•λ”κ² μΆ‹μ€λ°.....
κµ¬κΈ€μ— κ²€μƒ‰ν•΄λ³΄λ©΄......

![Spring μ΄λ―Έμ§€](/assets/images/spring082.png)

μ μ΄μ  μ½”λ“λ¥Ό μ§λ³΄μ.

```java
@Controller
public class ProductController {
    
    @GetMapping("/products/{id}")  //
    public String detail(@PathVariable Long id, Model model) {  // 
        Optional<Product> product = productRepository.findById(id);
        
        if (product.isPresent()) {  // 
            model.addAttribute("product", product.get());
            return "product.html";
        }
        return "redirect:/list";  // 
    }
}
```

```html
(products.html)

<body>
    <div th:replace="~{nav.html::navbar}"></div>

    <div class="detail" th:each="i : ${product}">
        <h4>μƒμ„Ένμ΄μ§€</h4>
        <img src="/images/anime.png" alt="μ• λ‹λ©”μ΄μ…">
        <h4 th:text="${i.title}">μƒν’</h4>
        <p th:text="${i.price}">κ°€κ²©</p>
    </div>
</body>
```
μ„μ μ½”λ“μ²λΌ 
- **PathVariable** + **urlνλΌλ―Έν„°**  
- **model.addAttribute(β€μ „λ‹¬ν•λ°μ΄ν„°μ΄λ¦„β€,β€λ°μ΄ν„°β€);**
- **thymleafλ°λ³µλ¬Έ**μ„ ν†µν•΄ μƒμ„Ένμ΄μ§€λ¥Ό μ κµ¬ν„ν–λ‹¤.

ν•λ² μ½”λ“κ°€ μ μ‹¤ν–‰μ΄ λλ”μ§€ ν™•μΈν•΄λ³΄μ.

![Spring μ΄λ―Έμ§€](/assets/images/spring083.png)
![Spring μ΄λ―Έμ§€](/assets/images/spring084.png)
![Spring μ΄λ―Έμ§€](/assets/images/spring085.png)

**idκ°’μ—λ”°λΌ μ„λ΅ λ‹¤λ¥Έ μƒν’**μ΄ λ‚μ¤λ”κ±Έ λ³Ό μ μλ‹¤.

```html
(list.html)

<div class="card" th:each="i : ${product}">
  <img src="https://placehold.co/300">
  <h4 th:text="${i.title}">μƒν’μ΄λ¦„</h4>
  <a href="@{'/products/' + ${i.id} }">λ§ν¬</a>
  <p th:text="${i.price + 'μ›'}">κ°€κ²©</p>
</div>
```
λ¦¬μ¤νΈνμ΄μ§€ λ§ν¬λ¥Ό νƒ€κ³  κ° μ μκ²λ„ ν•΄μ¤¬λ‹¤.
- hrefμ•μ—λ” @{ } λ¶€ν„° μ‹μ‘
- λ¬Έμλ” μ‘μ€ λ”°μ΄ν‘ μ•μ— λ„£κ³  + λ΅ ν•©μΉ μ μμ.


## κ²°λ΅ 
# β¨ **λ™μ  μƒν’ μƒμ„Ένμ΄μ§€ κµ¬ν„ μ™„μ„±!** β¨

| λ²νΈ | **ν•µμ‹¬ ν¬μΈνΈ** |
|------|-----------------|
| **1οΈβƒ£** | **URL νλΌλ―Έν„°** `{id}` + `@PathVariable`λ΅ λ™μ  λΌμ°ν…<br>`/products/{id}` ν• μ»¨νΈλ΅¤λ¬λ΅ **λ¬΄ν• μƒν’ νμ΄μ§€** μλ™ μƒμ„±! |
| **2οΈβƒ£** | **μ•μ „ν• λ°μ΄ν„° μ΅°ν** `Optional<Product>` μ‚¬μ©<br>`isPresent()`λ΅ null μ²΄ν¬ β†’ λ°μ΄ν„° μ—†μΌλ©΄ **λ¦¬λ‹¤μ΄λ ‰νΈ** |
| **3οΈβƒ£** | **λ·° λ°μ΄ν„° μ „λ‹¬** `model.addAttribute("product", ...)`<br>**Thymeleaf** `th:text`λ΅ **HTML λ™μ  λ λ”λ§** |
| **4οΈβƒ£** | **νμ΄μ§€ μ—°κ²°** λ¦¬μ¤νΈμ—μ„ `<a href="@{'/products/' + ${i.id}}">`<br>ν΄λ¦­ μ‹ **idλ³„ μƒμ„Ένμ΄μ§€**λ΅ μ΄λ™ |
| **5οΈβƒ£** | **μµμΆ… κ²°κ³Ό** `/products/1` β†’ 1λ² μƒν’, `/products/2` β†’ 2λ² μƒν’<br>**μ™„λ²½ν• λ™μ  μƒμ„Ένμ΄μ§€** μ¶λ ¥! π‰ |

---

**π’΅ ν• μ¤„ μ”μ•½**: ν• μ»¨νΈλ΅¤λ¬λ΅ **DB nκ° μƒν’** λ¨λ‘ μƒμ„Ένμ΄μ§€ μλ™ κµ¬ν„! π€










