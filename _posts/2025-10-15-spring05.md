---
layout: single
title: "DB데이터로 상품목록페이지 만들기"
excerpt: "DB에 있는 데이터를 활용하여 상품목록을 만들어보자!!!"
categories: SpringBoot
tag: SpringBoot
toc: true
published: true
---

지난시간에는 DB에서  데이터 출력하는 법을 배웠다. 3단계를 다시 복습해보자
1. repository를 만들자
2. DB입출력을 하고싶은 class에 1번에서만든 repository를 등록
3. DB입출력 문법을 쓰면된다(Lombok문법사용 ㅇㅇ 이게 간단하고 좋다)

그럼 이번에는 진짜 데이터를 가지고 상품목록을 만들어보자.

```java
@Controller
@RequiredArgsConstructor
public class ProductController {

    private final ProductRepository productRepository;

    @GetMapping("/list")
    String list(Model model) {
        List<Product> result = productRepository.findAll();
        System.out.println(result.get(0).title);

        model.addAttribute("product", result);
        return "list.html";
    }

}
```
## Thymeleaf를 사용하여 DB상품데이터 출력
.findAll()을 해서 result변수에 product테이블의 모든 데이터가 담겼다  
(여러 데이터이므로 result변수는 List자료형이다 정확히 List<Product>이다)
이제 이 데이터를 html에 꽂아주면 되는데 그건 저번시간에 배운대로  
model.addAttribute() 하면된다.  
model.addAttribute("product", result)  여기서 "product"에 result의 데이터를
담아서 thymeleaf에 써주면 된다. 실제 코드를 짜보자  


```html
<body>
    <div class="card">
        <img src="https://placehold.co/300">
        <div>
            <h4 th:text="${product.get(0).title}">더미타이틀</h4>
            <p th:text="${product.get(0).price}">더미가격</p>
        </div>
    </div>
    <div class="card">
        <img src="https://placehold.co/300">
        <div>
            <h4 th:text="${product.get(1).title}">더미타이틀1</h4>
            <p th:text="${product.get(1).price}">더미가격1</p>
        </div>
    </div>
</body>
```

DBeaver에는 다음과 같이 2개의 행의 데이터를 만들었다.
![Spring 이미지](/assets/images/spring05.png)

http://localhost:8080/list에 접속해서 제대로 DB에 있는 데이터가 적용됬는지 확인해보자

![Spring 이미지](/assets/images/spring051.png)  
제대로 들어간걸 확인할 수 있다.

근데 문제가 있다 만약 상품이 100만개면 100만개 코드를 일일이 타이핑하는건 불가능하다.
이럴때는 **반복문**을 이용해서 상품데이터를 출력하면 된다.

## Thymeleaf반복문을 이용한 DB상품데이터 출력

데이터가 2개밖에 없어서 임의로 3개더 만들어보고 반복문을 이용해서  
총 5개의 상품데이터를 출력해보자  
Thymeleaf의 반복문 문법은 간단하다. 
1. 반복하고싶은 html코드에 **th:each**를 붙이면 된다.
2. **th:each="변수명" : ${DB데이터가 저장되있는 변수}**
그럼 나는 변수명을 i로 하겠다. 반복문을 사용할때 관습적으로 가장 많이쓴다  
그리고 전달할데이터이름은 모였냐면 product이다. 그럼 코드를 작성해보자  

```html
<div class="card" th:each="i : ${product}">
  <img src="https://placehold.co/300">
  <div>
    <h4 th:text="${i.title}">더미타이틀</h4>
    <p th:text="${i.price}">더미가격</p>
  </div>
</div>
```
![Spring 이미지](/assets/images/spring052.png)
![Spring 이미지](/assets/images/spring053.png)

위의 사진과 같이 DB에 있는 5개의 상품이 추가된걸 볼 수 있다.
**thymeleaf반복문**을 이용하면 쉽게 많은데이터를 처리할 수 있다

## 결론
List 자료형으로 불러온 많은 데이터를 html에 출력하려면
**thymeleaf 반복문 th:each**를 써보자!
(th:each="변수명 : ${DB데이터가 저장되있는 변수}  
관습적으로 반복문에서 변수명은 i를 쓴다.)











