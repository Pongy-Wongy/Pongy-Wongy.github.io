---
layout: single
title: "상품등록하기1"
excerpt: "POST요청 배우기 및 CRUD란?"
categories: SpringBoot
tag: SpringBoot
toc: true
published: true
---

지금까지는 DB에 데이터를 일부로 집어넣어서 출력했는데
실제로는 글쓰기게시판,쇼핑몰게시판, 게시판같은 경우에는  
글쓰기 기능이 있어야 하지 않을까? 쇼핑몰도 마찬가지로  
상품도 등록할 수 있어야 되지 않을까?

그럼 생각해보자 글쓰기의 대표적인 구글폼을 생각하면
폼양식 있고,작성후 전송하면 그게 DB에 저장된다.

근데 문제가 있다. 이것저것 다 DB로 보내버리면 위험할수 있다.  
그래서 항상 **USER ➡️ 서버 ➡️ DB** 순서를 거치는게 좋다.

## 상품등록(글쓰기) 순서
1. 폼양식을 만든다
2. 전송하면 먼저 서버로 보낸다.
3. 서버가 글을 검사하고 OK면 DB로 저장

이제 실제로 코드를 짜보자

## 폼 양식 만들기
일단 폼양식html을 만들자  
나는 form.html이라고 만들겠다.

```html
<form>
  <input name="title">
  <input name="price">
  <button type="submit">버튼</button>
</form>
```

여기서 가장 중요한건 name속성의 값이 테이블column과 일치해야된다.
왜냐면 이 값이 서버로 전송되기 때문이다.

그 디음에는 ProductController에 form.html으로 접속할 수 있게 해주자
Get방식을 사용하면 되겠다.

```java
@GetMapping("/form")
String form(Model model) {
  return "form.html";
}
```
![Spring 이미지](/assets/images/spring06.png)

이제 서버에 input에 작성한 내용을 전송하면되는데 전송은  
어떻게 하냐면 **POST**요청방식을 사용하면된다.

일단 <form>태그안에 
```html
<form action="/product" method="POST">
  <input name="title">
  <input name="price">
  <button type="submit">버튼</button>
</form>
```
이렇게 하고 ProductController로 가서 
```java
@PostMapping("/product")
String addProduct(@RequestParam String title, @RequestParam Integer price) {
    System.out.println(title);
    System.out.println(price);
    return "redirect:/list";    
}
```
form에서 제출한 데이터를 출력하려면 함수 parameter에 
name속성의 타입에 맞게 값을적어주면 된다.
@RequestParam을 붙여야 값이 잘 전송된다.  
(원래 안적어도 되게 설정가능한데 하다가 잘 안돼서 일단함)

그럼 이제 한번 값을 입력해서 전송해보자
![Spring 이미지](/assets/images/spring061.png)
![Spring 이미지](/assets/images/spring062.png)

위의 사진과 POST방식으로 값이 잘 전송된걸 확인 할 수있다.

이제 POST방식으로 값을 DB에 저장하는 일만 남았다.

## POST요청으로 DB에 값 저장하기
천천히 생각해보자 전송을 하면 PostMapping("/product")의 API가 실행될것이고
당연히 함수 addProduct함수가 실행될거다. 그러면 여기 함수에 저장하는 기능을 만들면
장땡이다. 어디다가 저장하는건지 생각해야된다. product 테이블에 값을 저장하는 거다.
그럼 일단 product object를 하나 만든다. 그 다음에가 중요하다. 근데 어떻게 저장하는지는
모르면 생각한다고 답이나오냐? 응 안나온다.무조건 구글에 검색하든지 챗GPT형님한테 물어보자
![Spring 이미지](/assets/images/spring066.png)
**레퍼지토리.save()**를 해주고 product를 save안에 담아주면 끝이다.

```java
@PostMapping("/product")
    String addProduct(@RequestParam String title, @RequestParam Integer price) {
        Product product = new Product();
        product.setTitle(title);
        product.setPrice(price);
        productRepository.save(product);
        return "redirect:/list";
    }
```
위의 코드를 보면 setTitle,setPrice가 이렇게 적은걸 볼 수 있는데
왜 이렇게 썻는지모르면 다시 아직 코존못 자바초보가 맞다(설명생략)
이제 테이블이랑 redirect한 list페이지에 잘 저장 되있는지 확인해보자
![Spring 이미지](/assets/images/spring063.png)
![Spring 이미지](/assets/images/spring064.png)
![Spring 이미지](/assets/images/spring065.png)

위의 사진과 같이 POST요청으로 보낸 데이터가 테이블에 잘 저장되고
list페이지에도 잘 적용된걸 확인 할 수 있다.

지금까지 한 작업은 CRUD의 CREATE이다. 게시판에서는 글쓰기라고 생각하면된다.
그럼 CRUD가 뭔지 한번 검색해보자

## CRUD란?
챗 gpt한테 물어보자 내가 생각한다고 답이 나오는건 아니다.
![Spring 이미지](/assets/images/spring067.png)

위의 설명대로 우리는 새로운 데이터를 추가하는 Create를 한거다.

## 결론
1. 폼양식을 만든다.
2. POST요청방식으로 데이터를 서버에 전송한다.
3. 전송한 데이터를 테이블에 저장하려면 **레퍼지토리.save()** 하자.
4. 이게 CRUD의 **CREATE**다 끝!



 