---
layout: single
title: "DB에서 데이터 출력하기"
excerpt: "Lombok문법을 사용해서 DB에서 데이터 출력해보자!"
categories: SpringBoot
tag: SpringBoot
toc: true
published: true
---

## Lombok 라이브러리 설치
저버시간까지는 JPA방식으로 @Entity어노테이션을 이용해서
데이터베이스(DB) 테이블을 만드는 걸 공부했다. 그럼 오늘은 
테이블에 있는 데이터를 출력하는 걸 배워보자
배우기전에 Lombok라이브러리를 설치하자
(설치이유: 자바코드를 획기적으로 줄여주기때문에 필수적으로 쓰자!)
물론 Lombok 문법을 사용하지 않은 코드도 밑에다가 포스팅 해보겠다.

```java
dependencies {
  compileOnly 'org.projectlombok:lombok'
  annotationProcessor 'org.projectlombok:lombok'
}
```

build.gradle파일에 위의코드를 적어두면 라이브러리 설치 끝!

저번시간까지는 html에 서버데이터를 보내고, 테이블을 만들었는데 
이건 이번시간을 위한 빌드업이다. 이제 테이블에서 데이터를 꺼내는 
방법만 알면 된다.

## DB데이터 입출력하기
DB에 있는데이터를 입출력하려면  3단계만 기억하자.
1. repository를 만들자
2. DB입출력을 하고싶은 class에 1번에서만든 repository를 등록
3. DB입출력 문법을 쓰면된다(Lombok문법사용 ㅇㅇ 이게 간단하고 좋다)

말로설명하면 좀 어려우니 한번 코드를 짜보자.

### Repository interface 만들기
```java
public interface 레퍼지토리이름 extends JpaRepository<엔티티명, id컬럼타입> { 

} 
```
interface이름은 Entity이름 +  Repository 라고 짓자.

전 포스팅에서 Product 테이블을 만들었고 id타입은 integer로 만들었으니 코드는

```java

import org.springframework.data.jpa.repository.JpaRepository;

public interface ProductRepository extends JpaRepository <Product, Integer> {

}
```

이런식으로 코드를 짜면 되겠다.

interface에 관한설명은 자바고수들한테 설명필요없을거다 skip하자
그래도 코존못들을 위해서 설명하면(나도 코존못임 ㅠㅠ)
interface를 만들면  같은이름을 가진 class를 자동으로 생성해준다
그럼 우리는 자바 문법대로

```java
var 변수명 = new ProductRepository();
```

이렇게 쓸수 있는데 이 new ProductRepository() 여기에
DB입출력함수들이 개많아서 걍 사용하면 되는데
귀찮지 않나 매번 new ProductRepository() 쓰는게 매우 귀찮다 ㅇㅇ

## 뭐 할지 생각해라 바보멍충아(2단계 몬지 생각해라)

1. repository 만들었다.
근데 이거 왜 만들었음? DB 입출력하려고 만들었잔슴 right?
그래맞다 Product테이블에 있는 데이터를 입출력할거다.
근데 Product(상품) 상품API에관한 코드는 다 어디서 짜냐?
첫 시간에 배웠다 그래 Controller!! 
ProductController가서 코드를 짜보자!!

```java
@Controller
@RequiredArgsConstructor
public class ProductController {

    private final ProductRepository productRepository;//repostiry등록

    (Product API 코드 짜는 곳임 ㅇㅇ)

}

```
일단 Lombok문법 @RequiredArgsConstructor 어노테이션을 추가
그다음에 private final ProductRepository productRepository 이렇게 쓰면된다.

근데 Lombok문법을 안쓰고는 코드를 어떻게 짜나?

## @Autowired

```java
@Controller
public class ProductController {
  private final ProductRepository productRepository;

  @Autowired
  ProductController(ProductRepository productRepository) {
    this.productRepository = productRepository;
  }

  (상품API들 ~~)
} 
```

위의 코드를 보면 @RequiredArgsConstructor 라는게 어떤건지 대충감이오면
당신은 코존못 탈출임!!  @RequiredArgsConstructor 이걸쓰면 constructor
(생성자) 를 자동으로 만들어줌

이게 무슨말이냐면 Spring한테 object 민들어달라는거임 
그러면 Spring은 new ProductRepository() 해가주고 
productRepository 변수에 저장해줌
그러면 이제 object를 안만들어도되고 원할때마다
변수 productRepository를 사용하면 된다.
이게 DI(dependency Injection) 의존성 주입이다.
이것도 나중에 자세히 알아보자.(일단여기까지 이해하자)

## DB입출력문법 사용
이제 모든 준비가 끝나고 데이터를 뽑으면된다

```java
var result = productRepository.findAll();
```
한번실행해서 어떤값이 나오나 출력해보자

![Spring 이미지](/assets/images/spring04.png)

현재 product테이블에 총 3개의 행을 만들었더니
[]안에 3개가 있는걸 확인할 수 있다
[] 이건모냐면 list자료형이다(finAll을 쓰면 list자료형에 담긴다.)
그래서 위의 result변수의 실제 타입은 List<product> 이다.

## List 자료형을 쓰는 이유?
여러데이터를 한 변수에 넣을 때 매우 유용하다.

```java
var x = new ArrayList<>();
x.add(1);
x.add(2);
System.out.println(x);
```

```markdown
[1.2]
```
출력되는걸 볼 수 있다.

근데 위의 코드보다는 

```java
List<Integer> x = new ArrayList<>();
```
이렇게 쓰는게 더 깔끔하다. <>안에는 List자료의 타입을 넣어주면 된다.

정리하면 List자료형을 사용하면 여러데이터를 한 변수에 저장할 수 있어 좋다.

## .get()으로 데이터 불러오기

```java
@Controller
@RequiredArgsConstructor
public class ProductController {

    private final ProductRepository productRepository;

    @GetMapping("/list")
    String list(Model model) {
        List<Product> result = productRepository.findAll();
        System.out.println(result.get(0).title);
        return "list.html";
    }
}
```
.get(0).title Product테이블의 첫번째행의 title을 출력할 수 있다.
첫번째 행의 title은 '신발' 이다 
![Spring 이미지](/assets/images/spring041.png)

신발이 나오는걸 확인할 수 있다.

## 결론 

DB에 있는데이터를 입출력하려면  3단계만 기억하자.
1. repository를 만들자
2. DB입출력을 하고싶은 class에 1번에서만든 repository를 등록
3. DB입출력 문법을 쓰면된다(Lombok문법사용 ㅇㅇ 이게 간단하고 좋다)

List<> 자료형을 쓰면 여러데이터를 한 변수에 저장가능!

이번내용은 중요하니 꼭 다시한번 복습하자!!



