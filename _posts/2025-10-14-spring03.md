---
layout: single
title: "테이블 만들기 @Entity"
excerpt: "SQL문없이 Java코드로 테이블 만들기"
categories: SpringBoot
tag: SpringBoot
toc: true
published: true
---

저번 포스팅에서 thymeleaff를 사용해서 HTML에서 서버데이터를 보냈다.
이번시간에는 DB(데이터베이스)하나 만들어서 거기있는 데이터들을 뽑아보자.

2가 방법이 있는데 하나는 MyBatis 다른 하나는 JPA다.
간단히 설명하면 MyBatis는 SQL(쿼리문) 중심이고, JPA는 객체중심이다.

나는 JPA를 사용했다

## JPA란?
Java Persistance API 약자다 그럼 API는 모임?
API(Application Programming Interface) 약자다.간단히 쉽게 이해하면
'프로그램 사용법'이다.

```java
@Controller
public class ProductController {
    (상품 서버 API)
}
```
ProductController는 상품서버 API를 담고있는 class다.
상품등록,상품리스트불러오기,상품수정,상품삭제에 관한 코드를 
짜는 곳이다. 

다시 JPA로 넘어와서 JPA는 Java ORM 표준문법이다.
그럼 ORM 이건 뭐임?

### ORM(Object-Relational-Maping)
객체 관계 매핑이라고 부른다.
즉, 자바객체와 데이터베이스 테이블간의 매핑을 통해 데이터를 관리한다.

자 그러면 우리는 우선 테이블을 만들어야 한다.

## @Entity(테이블만들기)
원래는 테이블을 만들려면 쿼리문을 작성해야 하지만
ORM문법을 사용하면 그럴 필요가 없다.
자바 class 하나만들고 class위에 @Entity 어노테이션을 붙여주면 된다.

```java
import jakarta.persistence.Entity;

@Entity
public class Product {

}
```

이렇게 하면 Product테이블이 하나 생성 됬다.
이제 column 들을 추가하면 된다. 방법은 간단하다.

```java
import jakarta.persistence.Entity;

@Entity
public class Product {
  @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
  private Integer id;
  private String title;
  private Integer price;
}
```

이렇게 하면 총 3개의 colum을 만들었다.(상품id, 상품타이틀, 상품가격)
@GenratedValue 붙여두면 상품을 하나 추가할때 1씩증가한다 
정확히는 @Id 어노테이션이있는 id값이 1씩증가한다.
(데이터들끼리 서로 구분하기위해 id컬럼은 @Id라고 표기하자!!)

@Id는 SQL에서 기본키(Primary key),
@GeneratedValue는 SQL에서 auto increament 이다.

## @Column 제약조건
```java
@Column(length = 100)
private String title;
```
@Column 어노테이션을 사용하면 제약조건을 걸 수 있다.
위의 제약조건은 title의 글자수를 100까지 제한한다.
100자가 넘어가면 DB저장실패!

이 위에도 여러가지 있는데 필요할때 찾아서 쓰자.

그럼 한번 테이블이 생성됬는지 확인해보자

DBeaver에 들어가서 확인해보면

![Spring 이미지](/assets/images/spring03.png)

테이블이 생성완료!!

## 결론
1. 테이블 만들때는 @Entity 붙은 class 하나 만들면 자동으로 생성

2. 그 class에 멤버변수(필드) 만들면 그게 자동으로 컬럼으로 변합니다.

3. @id 컬럼은 항상 하나 있는게 좋습니다. @GeneratedValue 넣는 것도 편함(1씩증가!)

4. @Column 사용해서 컬럼마다 제약조건 부여하기